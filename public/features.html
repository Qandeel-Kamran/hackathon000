<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Features - Physical AI & Humanoid Robotics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 1rem;
        }

        .feature-number {
            background-color: var(--secondary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 0 auto 1rem;
        }

        .footer {
            background-color: var(--dark-color);
            color: white;
            padding: 3rem 0 1.5rem;
            margin-top: 3rem;
        }

        .modal-content {
            border-radius: 8px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <i class="fas fa-robot me-2"></i>
                <span class="fw-bold">Physical AI Book</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home me-1"></i> Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="chapters.html"><i class="fas fa-book me-1"></i> Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="features.html"><i class="fas fa-star me-1"></i> Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html"><i class="fas fa-info-circle me-1"></i> About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-3">Interactive Learning Features</h1>
            <p class="lead mb-4">Explore the comprehensive learning tools and interactive features</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5">
                <h2 class="text-primary">Enhanced Learning Experience</h2>
                <p class="lead">Our platform offers a variety of interactive features designed to enhance your understanding of Physical AI and Humanoid Robotics concepts.</p>
            </div>
        </div>

        <div class="row g-4" id="features-container">
            <!-- Features will be loaded dynamically -->
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-code"></i>
                    </div>
                    <h4>Loading...</h4>
                    <p>Loading feature description...</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h4>Loading...</h4>
                    <p>Loading feature description...</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h4>Loading...</h4>
                    <p>Loading feature description...</p>
                </div>
            </div>
        </div>

        <!-- Feature Details Modal -->
        <div class="modal fade" id="featureModal" tabindex="-1" aria-labelledby="featureModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="featureModalLabel">Feature Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="featureModalBody">
                        <!-- Feature details will be loaded here -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>Physical AI Book</h5>
                    <p>Interactive learning platform for Physical AI and Humanoid Robotics concepts.</p>
                </div>
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="/" class="text-light">Home</a></li>
                        <li><a href="chapters.html" class="text-light">Chapters</a></li>
                        <li><a href="features.html" class="text-light">Features</a></li>
                        <li><a href="about.html" class="text-light">About</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Connect</h5>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-light"><i class="fab fa-github fa-2x"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-twitter fa-2x"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-linkedin fa-2x"></i></a>
                    </div>
                </div>
            </div>
            <hr class="my-4 bg-light">
            <div class="text-center">
                <p class="mb-0">&copy; 2025 Physical AI Book. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Floating Chat Button -->
    <div class="floating-chat-btn" style="position: fixed; bottom: 30px; right: 30px; z-index: 1000;">
        <button id="chat-toggle-btn" class="btn btn-primary btn-lg rounded-circle shadow" style="width: 60px; height: 60px; border-radius: 50% !important;" onclick="toggleChat()">
            <i class="fas fa-question-circle fa-2x"></i>
        </button>
    </div>

    <!-- Chat Modal -->
    <div class="modal fade" id="chatModal" tabindex="-1" aria-labelledby="chatModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-end">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-question-circle fa-2x me-3"></i>
                        <div>
                            <h5 class="modal-title mb-0" id="chatModalLabel">Book Assistant</h5>
                            <small class="opacity-75">Ask me anything about robotics!</small>
                        </div>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="row g-0">
                        <div class="col-8">
                            <div id="chat-messages-modal" class="p-3" style="height: 400px; overflow-y: auto; background-color: #f8f9fa;">
                                <div class="message ai-message mb-3">
                                    <div class="d-flex align-items-start">
                                        <div class="avatar bg-primary rounded-circle p-2 me-3">
                                            <i class="fas fa-question-circle text-white"></i>
                                        </div>
                                        <div class="bg-light rounded p-3 flex-grow-1">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <small class="text-muted">Book Assistant</small>
                                                <small class="text-muted">Just now</small>
                                            </div>
                                            <p class="mb-0 mt-1">Hello! I'm your Book Assistant for Physical AI and Humanoid Robotics. Feel free to ask me any questions about the content, concepts, or applications in robotics and AI.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-4 border-start bg-light">
                            <div class="p-3">
                                <h6 class="mb-3 text-primary"><i class="fas fa-lightbulb me-2"></i>Quick Questions</h6>
                                <div class="d-grid gap-2 mb-3">
                                    <button class="btn btn-outline-primary btn-sm" onclick="sendQuickMessageModal('Explain forward kinematics')">Forward Kinematics</button>
                                    <button class="btn btn-outline-primary btn-sm" onclick="sendQuickMessageModal('How does PID control work in robotics?')">PID Control</button>
                                    <button class="btn btn-outline-primary btn-sm" onclick="sendQuickMessageModal('What is the difference between holonomic and non-holonomic robots?')">Robot Types</button>
                                    <button class="btn btn-outline-primary btn-sm" onclick="sendQuickMessageModal('Explain ZMP in humanoid robotics')">ZMP in Humanoids</button>
                                </div>
                                <div class="bg-white rounded p-2 mb-2">
                                    <small class="text-muted">ðŸ’¡ Ask about textbook chapters!</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <div class="input-group">
                        <input type="text" id="message-input-modal" class="form-control" placeholder="Ask a question about Physical AI, robotics, or any chapter content..." onkeypress="handleMessageKeyPressModal(event)">
                        <button class="btn btn-primary" type="button" onclick="sendMessageModal()">
                            <i class="fas fa-paper-plane me-1"></i> Send
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Load features from API
        async function loadFeatures() {
            try {
                const response = await fetch('/api/features');
                const data = await response.json();

                const container = document.getElementById('features-container');
                container.innerHTML = '';

                data.features.forEach((feature, index) => {
                    const colDiv = document.createElement('div');
                    colDiv.className = 'col-md-4';
                    colDiv.innerHTML = `
                        <div class="feature-card" onclick="showFeatureDetails('${feature.id}', '${feature.title}', '${feature.details.replace(/'/g, "\\'")}', '${feature.icon}')">
                            <div class="feature-number">${index + 1}</div>
                            <div class="feature-icon">
                                <i class="${feature.icon}"></i>
                            </div>
                            <h4>${feature.title}</h4>
                            <p>${feature.description}</p>
                        </div>
                    `;
                    container.appendChild(colDiv);
                });
            } catch (error) {
                console.error('Error loading features:', error);
            }
        }

        // Function to show feature details in a modal
        function showFeatureDetails(id, title, details, icon) {
            // Update modal content
            document.getElementById('featureModalLabel').innerHTML = `
                <i class="${icon} me-2"></i>${title}
            `;
            document.getElementById('featureModalBody').innerHTML = `
                <div class="feature-detail-content">
                    <p class="lead">${details}</p>
                    <div class="alert alert-info">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>Try it out:</strong> Look for this feature throughout the textbook content to see it in action!
                    </div>
                </div>
            `;

            // Show the modal
            const modalElement = document.getElementById('featureModal');
            const modal = new bootstrap.Modal(modalElement);
            modal.show();
        }

        // Modal chat functionality (copy from main page)
        let chatModal = null;

        function toggleChat() {
            const modalElement = document.getElementById('chatModal');
            chatModal = chatModal || new bootstrap.Modal(modalElement);

            // If modal is hidden, show it; if shown, hide it
            const modal = bootstrap.Modal.getInstance(modalElement) || chatModal;
            if (modalElement.classList.contains('show')) {
                modal.hide();
            } else {
                modal.show();
            }
        }

        function addMessageToChatModal(sender, message, isUser = false) {
            const chatMessages = document.getElementById('chat-messages-modal');

            const messageElement = document.createElement('div');
            messageElement.className = `message ${isUser ? 'user-message' : 'ai-message'} mb-3`;

            const avatarClass = isUser ? 'bg-success' : 'bg-primary';
            const senderName = isUser ? 'You' : 'Book Assistant';
            const icon = isUser ? 'fas fa-user' : 'fas fa-question-circle';

            messageElement.innerHTML = `
                <div class="d-flex align-items-start">
                    <div class="avatar ${avatarClass} rounded-circle p-2 me-3">
                        <i class="${icon} text-white"></i>
                    </div>
                    <div class="${isUser ? 'bg-success text-white' : 'bg-light'} rounded p-3 flex-grow-1">
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">${senderName}</small>
                            <small class="text-muted">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</small>
                        </div>
                        <p class="mb-0 mt-1">${message}</p>
                    </div>
                </div>
            `;

            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function sendMessageModal() {
            const input = document.getElementById('message-input-modal');
            const message = input.value.trim();

            if (!message) return;

            // Add user message to chat
            addMessageToChatModal('You', message, true);
            input.value = '';

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });

                const data = await response.json();

                if (data.success) {
                    addMessageToChatModal('Book Assistant', data.response, false);
                } else {
                    addMessageToChatModal('Book Assistant', 'Sorry, I encountered an error processing your request. Please try again.', false);
                }
            } catch (error) {
                console.error('Error sending message:', error);
                addMessageToChatModal('Book Assistant', 'Sorry, I encountered an error processing your request. Please try again.', false);
            }
        }

        function sendQuickMessageModal(message) {
            document.getElementById('message-input-modal').value = message;
            sendMessageModal();
        }

        function handleMessageKeyPressModal(event) {
            if (event.key === 'Enter') {
                sendMessageModal();
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadFeatures();

            // Set up the initial message
            if (document.getElementById('chat-messages-modal').children.length === 0) {
                addMessageToChatModal('Book Assistant', "Hello! I'm your Book Assistant for Physical AI and Humanoid Robotics. Feel free to ask me any questions about the content, concepts, or applications in robotics and AI.", false);
            }
        });

        // Make functions available globally
        window.toggleChat = toggleChat;
        window.sendMessageModal = sendMessageModal;
        window.sendQuickMessageModal = sendQuickMessageModal;
        window.handleMessageKeyPressModal = handleMessageKeyPressModal;
        window.addMessageToChatModal = addMessageToChatModal;
        window.showFeatureDetails = showFeatureDetails;
    </script>
</body>
</html>